import{a as e,r as t,o as l,b as n,c as o,d as s,t as r,F as a,w as i,v as u,e as c,f,g as p,h as d}from"./vendor.c9688ef5.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const l of e)if("childList"===l.type)for(const e of l.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const m=c("發送身份認證碼到 "),v={key:2,class:"error"},g={emits:["nextStep"],setup(c,{emit:f}){const p=t(""),d=t(""),g=t(""),y=t(""),b=t(""),h=t=>{((t,l,n)=>{let o=JSON.stringify({name:t,mail:l,token:n});return e.post("https://script.google.com/macros/s/AKfycbxpx6GgQiGJYGeR0t8jO2NvTqnM02k8sinIHXGWlnqsx3tyYVWNlDBSUqiBdlKG_bAsYg/exec",o,{headers:{"content-type":"application/x-www-form-urlencoded"}}).then((e=>e||Promise.reject())).catch((e=>{console.log("error",e)}))})(p.value,t,d.value).then((e=>{console.log("res: ",e);const t=e.data.message;f("nextStep",t)})).catch((e=>{console.log("err: ",e)}))};return l((()=>{liff.init({liffId:"1656419833-74JqODyP"}).then((()=>{(()=>{if(liff.isLoggedIn()&&liff.isInClient()){const e=liff.getDecodedIDToken();p.value=e&&e.name,d.value=e&&e.sub,g.value=e&&e.email}else b.value="please use line liff open"})()})).catch((e=>{console.log(e),b.value="initialize LIFF fail"}))})),(e,t)=>g.value&&!b.value?(n(),o(a,{key:0},[s("p",null,"將發送身份認證碼到 "+r(g.value),1),s("button",{type:"button",class:"btn",onClick:t[0]||(t[0]=e=>h(g.value))},"確定")],64)):b.value?(n(),o("p",v,r(b.value),1)):(n(),o(a,{key:1},[s("p",null,[m,i(s("input",{type:"email","onUpdate:modelValue":t[1]||(t[1]=e=>y.value=e),placeholder:"請輸入 Email"},null,512),[[u,y.value]])]),s("button",{type:"button",class:"btn",onClick:t[2]||(t[2]=e=>h(y.value))},"確定")],64))}};var y=((e,t)=>{for(const[l,n]of t)e[l]=n;return e})({name:"BindMailResult",props:{result:{type:String}}},[["render",function(e,t,l,i,u,c){return n(),o(a,null,[s("p",null,r("success"===l.result?"已將驗證碼發送至信箱":"發送失敗，請稍後再試"),1),s("button",{type:"button",class:"btn",onClick:t[0]||(t[0]=t=>e.liff.closewindow())},"關閉")],64)}]]);const b=s("h1",null,"驗證碼小幫手 - 身份認證",-1),h={setup(e){const l=t("form"),s=t(""),r=e=>{s.value=e,l.value="result"};return(e,t)=>(n(),o(a,null,[b,(n(),f(p("form"===l.value?g:y),{result:s.value,onNextStep:r},null,8,["result"]))],64))}};d({setup:e=>(e,t)=>(n(),f(h))}).mount("#app");
